# Docker Backup & Restore Tool

ğŸ³ ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„Dockeråº”ç”¨å¤‡ä»½æ¢å¤å·¥å…·ï¼Œæ”¯æŒäº¤äº’å¼æ“ä½œã€å¤šç§å¤‡ä»½æ¨¡å¼å’Œè·¨æœåŠ¡å™¨éƒ¨ç½²ã€‚

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Shell Script](https://img.shields.io/badge/Language-Shell-green.svg)](https://www.gnu.org/software/bash/)
[![Docker](https://img.shields.io/badge/Docker-Compatible-blue.svg)](https://www.docker.com/)
[![Linux](https://img.shields.io/badge/OS-Linux-orange.svg)](https://www.linux.org/)

## âœ¨ ç‰¹æ€§

- ğŸ¯ **å•æ–‡ä»¶è§£å†³æ–¹æ¡ˆ** - ä»…éœ€ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½
- ğŸ¨ **äº¤äº’å¼ç•Œé¢** - å½©è‰²èœå•ï¼Œæ“ä½œç®€å•ç›´è§‚
- ğŸ”„ **å¤šç§å¤‡ä»½æ¨¡å¼** - å®Œæ•´å¤‡ä»½/ä»…é…ç½®/ä»…æ•°æ®/è‡ªå®šä¹‰é€‰æ‹©
- â° **å®šæ—¶å¤‡ä»½** - æ”¯æŒå¤šç§æ—¶é—´ç­–ç•¥é…ç½®
- ğŸŒ **è·¨æœåŠ¡å™¨å…¼å®¹** - å¤‡ä»½æ–‡ä»¶å¯åœ¨ä»»ä½•Linuxç³»ç»Ÿæ¢å¤
- ğŸ”§ **æ™ºèƒ½æ¢å¤** - è‡ªåŠ¨ç”Ÿæˆå®¹å™¨å¯åŠ¨è„šæœ¬
- ğŸ“¦ **è‡ªåŠ¨å‹ç¼©** - æ–°å¤‡ä»½è‡ªåŠ¨æ›¿æ¢æ—§å¤‡ä»½ï¼ŒèŠ‚çœç©ºé—´
- ğŸ“ **è¯¦ç»†æ—¥å¿—** - å®Œæ•´çš„æ“ä½œè®°å½•å’Œé”™è¯¯è¿½è¸ª

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸€é”®è¿œç¨‹ä½¿ç”¨

```bash
# è‡ªåŠ¨å¤‡ä»½ï¼ˆæ¨èï¼‰- ç›´æ¥æ‰§è¡Œå¤‡ä»½
curl -fsSL https://raw.githubusercontent.com/moli-xia/docker-backup-tool/main/docker_backup_all_in_one.sh | bash -s -- --auto

# å®‰è£…åˆ°æœ¬åœ° - ä¸‹è½½è„šæœ¬åˆ°æœ¬åœ°ä½¿ç”¨
curl -fsSL https://raw.githubusercontent.com/moli-xia/docker-backup-tool/main/docker_backup_all_in_one.sh | bash -s -- --install

# é»˜è®¤æ¨¡å¼ - 5ç§’å€’è®¡æ—¶åè‡ªåŠ¨å¤‡ä»½ï¼ˆå¯Ctrl+Cå–æ¶ˆï¼‰
curl -fsSL https://raw.githubusercontent.com/moli-xia/docker-backup-tool/main/docker_backup_all_in_one.sh | bash
```

#### ğŸ’¡ è¿œç¨‹æ‰§è¡Œè¯´æ˜

- **æ¨èä½¿ç”¨ `--auto` å‚æ•°**ï¼šç›´æ¥æ‰§è¡Œå¤‡ä»½ï¼Œæ— å»¶è¿Ÿ
- **ä½¿ç”¨ `--install` å‚æ•°**ï¼šå®‰è£…åˆ°æœ¬åœ°åå¯å®Œæ•´ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½  
- **é»˜è®¤æ¨¡å¼**ï¼šç”±äºç®¡é“é™åˆ¶æ— æ³•çœŸæ­£äº¤äº’ï¼Œä¼šæ˜¾ç¤ºæç¤ºåè‡ªåŠ¨å¤‡ä»½

### å®‰è£…åˆ°æœ¬åœ°ä½¿ç”¨

```bash
# æ–¹æ³•1ï¼šè¿œç¨‹å®‰è£…ï¼ˆæ¨èï¼‰
curl -fsSL https://raw.githubusercontent.com/moli-xia/docker-backup-tool/main/docker_backup_all_in_one.sh | bash
# ç„¶åé€‰æ‹©é€‰é¡¹3

# æ–¹æ³•2ï¼šæ‰‹åŠ¨ä¸‹è½½
wget https://raw.githubusercontent.com/moli-xia/docker-backup-tool/main/docker_backup_all_in_one.sh
chmod +x docker_backup_all_in_one.sh

# å¯åŠ¨æœ¬åœ°ç•Œé¢
./docker_backup_all_in_one.sh
```

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

### äº¤äº’å¼æ¨¡å¼ï¼ˆæ¨èï¼‰

```bash
./docker_backup_all_in_one.sh
```

å¯åŠ¨åä¼šæ˜¾ç¤ºä¸»èœå•ï¼š
```
ä¸»èœå•ï¼š
1) ğŸ”„ æ‰§è¡Œå¤‡ä»½
2) ğŸ“¥ æ¢å¤å¤‡ä»½  
3) â° å®šæ—¶å¤‡ä»½
4) ğŸ“‹ å¤‡ä»½å†å²
5) â“ å¸®åŠ©ä¿¡æ¯
6) ğŸšª é€€å‡º
```

### è‡ªåŠ¨å¤‡ä»½æ¨¡å¼

```bash
# æ‰§è¡Œå®Œæ•´è‡ªåŠ¨å¤‡ä»½
./docker_backup_all_in_one.sh --auto

# å®‰è£…åˆ°æœ¬åœ°ç³»ç»Ÿ
./docker_backup_all_in_one.sh --install

# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
./docker_backup_all_in_one.sh --help
```

## ğŸ”§ å¤‡ä»½æ¨¡å¼

| æ¨¡å¼ | æè¿° | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **å®Œæ•´å¤‡ä»½** | å®¹å™¨é…ç½® + æ•°æ®å· + é•œåƒä¿¡æ¯ | ç”Ÿäº§ç¯å¢ƒã€æœåŠ¡å™¨è¿ç§» |
| **ä»…é…ç½®** | å®¹å™¨é…ç½® + ç¯å¢ƒå˜é‡ | å¿«é€Ÿé…ç½®å¤‡ä»½ |
| **ä»…æ•°æ®** | æ•°æ®å· + æŒ‚è½½ç›®å½• | æ•°æ®å®‰å…¨å¤‡ä»½ |
| **è‡ªå®šä¹‰** | æ‰‹åŠ¨é€‰æ‹©å®¹å™¨ | ç‰¹å®šå®¹å™¨å¤‡ä»½ |

## â° å®šæ—¶å¤‡ä»½é…ç½®

æ”¯æŒå¤šç§å®šæ—¶ç­–ç•¥ï¼š

- æ¯å¤©å‡Œæ™¨2ç‚¹
- æ¯å‘¨æ—¥å‡Œæ™¨2ç‚¹
- æ¯æœˆ1å·å‡Œæ™¨2ç‚¹
- è‡ªå®šä¹‰Cronè¡¨è¾¾å¼

é…ç½®åä¼šè‡ªåŠ¨æ·»åŠ åˆ°ç³»ç»Ÿcrontabä¸­ã€‚

## ğŸŒ è·¨æœåŠ¡å™¨æ¢å¤

### æ­¥éª¤1ï¼šåœ¨æºæœåŠ¡å™¨å¤‡ä»½

```bash
# æ‰§è¡Œå¤‡ä»½
./docker_backup_all_in_one.sh --auto

# æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶
ls -la /opt/docker_backups/
```

### æ­¥éª¤2ï¼šä¼ è¾“åˆ°ç›®æ ‡æœåŠ¡å™¨

```bash
# å¤åˆ¶å¤‡ä»½æ–‡ä»¶
scp /opt/docker_backups/docker_backup_*.tar.gz user@target-server:/tmp/

# å¤åˆ¶æ¢å¤è„šæœ¬ï¼ˆå¦‚æœéœ€è¦ï¼‰
scp /opt/docker_backups/restore_backup.sh user@target-server:/tmp/
```

### æ­¥éª¤3ï¼šåœ¨ç›®æ ‡æœåŠ¡å™¨æ¢å¤

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨æœ¬å·¥å…·æ¢å¤
./docker_backup_all_in_one.sh
# é€‰æ‹©èœå•é¡¹2ï¼ˆæ¢å¤å¤‡ä»½ï¼‰

# æ–¹æ³•2ï¼šç›´æ¥ä½¿ç”¨æ¢å¤è„šæœ¬
./restore_backup.sh /tmp/docker_backup_*.tar.gz
```

## ğŸ“¦ å¤‡ä»½å†…å®¹

æ¯æ¬¡å¤‡ä»½åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

### å®¹å™¨é…ç½®
- å®Œæ•´çš„å®¹å™¨é…ç½®ï¼ˆJSONæ ¼å¼ï¼‰
- ç¯å¢ƒå˜é‡å’Œå¯åŠ¨å‚æ•°
- ç«¯å£æ˜ å°„å’Œç½‘ç»œé…ç½®
- é‡å¯ç­–ç•¥å’Œå¥åº·æ£€æŸ¥
- æ ‡ç­¾å’Œå…ƒæ•°æ®

### æ•°æ®æ–‡ä»¶
- Dockeræ•°æ®å·ï¼ˆå®Œæ•´å¤‡ä»½ï¼‰
- ç»‘å®šæŒ‚è½½ç›®å½•
- é…ç½®æ–‡ä»¶å’Œåº”ç”¨æ•°æ®

### è‡ªåŠ¨åŒ–è„šæœ¬
- å®¹å™¨å¯åŠ¨è„šæœ¬ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
- æ‰¹é‡æ¢å¤è„šæœ¬
- ç³»ç»Ÿç¯å¢ƒä¿¡æ¯

## ğŸ› ï¸ ç³»ç»Ÿè¦æ±‚

### åŸºç¡€è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: ä»»ä½•Linuxå‘è¡Œç‰ˆ
- **Docker**: 17.06 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æƒé™**: rootç”¨æˆ·æˆ–dockerç»„æˆå‘˜
- **ç£ç›˜ç©ºé—´**: å»ºè®®è‡³å°‘ä¸ºå®¹å™¨æ•°æ®æ€»å¤§å°çš„2å€

### ä¾èµ–å‘½ä»¤
è„šæœ¬ä»…ä¾èµ–åŸºç¡€Linuxå‘½ä»¤ï¼š
- `docker` - Dockerå¼•æ“
- `tar` - å‹ç¼©è§£å‹
- `gzip` - å‹ç¼©å·¥å…·
- `find` - æ–‡ä»¶æŸ¥æ‰¾
- `date` - æ—¶é—´å¤„ç†
- `crontab` - å®šæ—¶ä»»åŠ¡ï¼ˆå¯é€‰ï¼‰

### å…¼å®¹æ€§æµ‹è¯•

âœ… **å·²æµ‹è¯•çš„ç³»ç»Ÿ**:
- Ubuntu 18.04/20.04/22.04
- CentOS 7/8/Stream
- Debian 9/10/11
- RHEL 7/8/9
- Alpine Linux
- å®å¡”é¢æ¿ç¯å¢ƒ

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### æ•°æ®ä¿æŠ¤
- éç ´åæ€§æ“ä½œè®¾è®¡
- æ“ä½œå‰ç¡®è®¤æç¤º
- å®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•
- æ”¯æŒå¤‡ä»½æ–‡ä»¶åŠ å¯†ï¼ˆå¯é€‰ï¼‰

### æƒé™æ§åˆ¶
```bash
# è®¾ç½®å¤‡ä»½ç›®å½•æƒé™
chmod 700 /opt/docker_backups

# é™åˆ¶è„šæœ¬è®¿é—®æƒé™
chmod 750 docker_backup_all_in_one.sh
```

## ğŸ“Š æ€§èƒ½è¡¨ç°

### æµ‹è¯•ç¯å¢ƒ
- **ç³»ç»Ÿ**: Linux 5.10.0-32-cloud-amd64
- **Docker**: v27.2.0
- **å®¹å™¨æ•°é‡**: 3ä¸ªï¼ˆmemos, moontv, libretvï¼‰

### æµ‹è¯•ç»“æœ
- **å¤‡ä»½æ—¶é—´**: ~47ç§’
- **å¤‡ä»½å¤§å°**: 221MBï¼ˆå®Œæ•´å¤‡ä»½ï¼‰
- **æˆåŠŸç‡**: 100%
- **æ¢å¤æ—¶é—´**: <2åˆ†é’Ÿ

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æƒé™é”™è¯¯
```bash
# æ·»åŠ ç”¨æˆ·åˆ°dockerç»„
sudo usermod -aG docker $USER

# æˆ–è€…ä½¿ç”¨sudoè¿è¡Œ
sudo ./docker_backup_all_in_one.sh
```

#### 2. ç£ç›˜ç©ºé—´ä¸è¶³
```bash
# æ¸…ç†Dockerç¼“å­˜
docker system prune -a

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨
df -h
```

#### 3. å®¹å™¨å¯åŠ¨å¤±è´¥
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :ç«¯å£å·

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs å®¹å™¨å

# æ£€æŸ¥é•œåƒæ˜¯å¦å­˜åœ¨
docker images
```

#### 4. è¿œç¨‹æ‰§è¡Œé—®é¢˜
```bash
# å¦‚æœ curl | bash æ‰§è¡Œå¤±è´¥ï¼Œå¯ä»¥å…ˆä¸‹è½½åˆ°æœ¬åœ°
wget https://raw.githubusercontent.com/moli-xia/docker-backup-tool/main/docker_backup_all_in_one.sh
chmod +x docker_backup_all_in_one.sh
./docker_backup_all_in_one.sh

# æˆ–è€…ä½¿ç”¨å®‰è£…æ¨¡å¼
curl -fsSL https://raw.githubusercontent.com/moli-xia/docker-backup-tool/main/docker_backup_all_in_one.sh | bash -s -- --install
```

#### 5. æ¢å¤è„šæœ¬é—®é¢˜
- æ£€æŸ¥å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§ï¼š`tar -tzf å¤‡ä»½æ–‡ä»¶.tar.gz`
- ç¡®è®¤ç›®æ ‡è·¯å¾„æƒé™æ­£ç¡®
- æ‰‹åŠ¨è°ƒæ•´å¯åŠ¨è„šæœ¬ä¸­çš„æŒ‚è½½è·¯å¾„

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†è¾“å‡º
bash -x ./docker_backup_all_in_one.sh --auto

# æŸ¥çœ‹å¤‡ä»½æ—¥å¿—
tail -f /opt/docker_backups/backup_*.log
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v3.0 (å½“å‰ç‰ˆæœ¬)
- âœ¨ å…¨æ–°å•æ–‡ä»¶æ¶æ„è®¾è®¡
- âœ¨ äº¤äº’å¼å½©è‰²ç•Œé¢
- âœ¨ æ™ºèƒ½å¤‡ä»½æ¨¡å¼é€‰æ‹©
- âœ¨ å¢å¼ºçš„è·¨æœåŠ¡å™¨å…¼å®¹æ€§
- âœ¨ è‡ªåŠ¨ç”Ÿæˆæ¢å¤è„šæœ¬
- âœ¨ å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼

### å¦‚ä½•è´¡çŒ®
1. Fork è¿™ä¸ªé¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

### æŠ¥å‘Šé—®é¢˜
å¦‚æœæ‚¨å‘ç°bugæˆ–æœ‰åŠŸèƒ½å»ºè®®ï¼Œè¯·[åˆ›å»ºIssue](https://github.com/moli-xia/docker-backup-tool/issues)ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢æ‰€æœ‰Dockerç¤¾åŒºçš„è´¡çŒ®è€…
- æ„Ÿè°¢ä½¿ç”¨å’Œæµ‹è¯•æ­¤å·¥å…·çš„ç”¨æˆ·ä»¬

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªé¡¹ç›®æœ‰ç”¨ï¼Œè¯·ç»™å®ƒä¸€ä¸ª â­ï¸

### è·å–å¸®åŠ©
- ğŸ“– æŸ¥çœ‹è„šæœ¬å†…ç½®å¸®åŠ©ï¼š`./docker_backup_all_in_one.sh --help`
- ğŸ› æŠ¥å‘Šé—®é¢˜ï¼š[GitHub Issues](https://github.com/moli-xia/docker-backup-tool/issues)
- ğŸ’¬ è®¨è®ºäº¤æµï¼š[GitHub Discussions](https://github.com/moli-xia/docker-backup-tool/discussions)

---

**è®©Dockeråº”ç”¨å¤‡ä»½å˜å¾—ç®€å•è€Œå¯é ï¼** ğŸš€
